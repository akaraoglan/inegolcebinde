<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Firma Listesi</title>

  <!-- PapaParse -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

  <style>
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f4f6fb;
    }

    header {
      background: #fff;
      padding: 16px;
      box-shadow: 0 2px 8px rgba(0,0,0,.05);
      position: sticky;
      top: 0;
      z-index: 10;
    }

    .search {
      max-width: 900px;
      margin: auto;
      display: flex;
      gap: 10px;
      justify-content: center;
      flex-wrap: wrap;
    }

    input {
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #ccc;
      width: 220px;
    }

    main {
      max-width: 1100px;
      margin: 20px auto;
      padding: 0 12px;
      display: flex;
      gap: 16px;
    }

    aside {
      background: #fff;
      border-radius: 12px;
      padding: 12px;
      min-width: 180px;
    }

    .cat {
      padding: 8px;
      border-radius: 6px;
      cursor: pointer;
    }

    .cat.active,
    .cat:hover {
      background: #007bff;
      color: #fff;
    }

    .list {
      flex: 1;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
      gap: 14px;
    }

    .card {
      background: #fff;
      border-radius: 14px;
      padding: 14px;
      box-shadow: 0 4px 10px rgba(0,0,0,.06);
    }

    .card h4 {
      margin: 0 0 6px 0;
    }

    .tag {
      font-size: 13px;
      color: #666;
    }

    .label {
      margin-top: 6px;
      font-size: 12px;
      color: #007bff;
      font-weight: 600;
    }

    @media (max-width: 768px) {
      main { flex-direction: column; }
      aside { display: flex; gap: 8px; overflow-x: auto; }
    }
  </style>
</head>
<body>

<header>
  <div class="search">
    <input id="searchName" placeholder="Firma adı ile ara">
    <input id="searchTag" placeholder="Etiket ile ara">
  </div>
</header>

<main>
  <aside id="categories"></aside>
  <section class="list" id="list"></section>
</main>

<script>
const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vR0_uoscZglFTi3l3RMoVyLq3P8pajjDg7WXPVdRHiJ25hqLE4g2HvXDWqhxKnfVpnjEJ2evncgvgU2/pub?gid=1659204540&single=true&output=csv";

let data = [];
let activeCategory = "";

Papa.parse(CSV_URL, {
  download: true,
  header: true,
  complete: res => {
    data = res.data.map(r => ({
      name: r[Object.keys(r)[1]],
      tag: r[Object.keys(r)[2]],
      category: r[Object.keys(r)[3]],
    })).filter(x => x.name);

    renderCategories();
    renderList();
  }
});

function renderCategories() {
  const cats = [...new Set(data.map(d => d.category))];
  const el = document.getElementById("categories");
  el.innerHTML = "";

  addCat("Tümü", "");

  cats.forEach(c => addCat(c, c));
}

function addCat(text, value) {
  const div = document.createElement("div");
  div.className = "cat" + (activeCategory === value ? " active" : "");
  div.textContent = text;
  div.onclick = () => {
    activeCategory = value;
    renderCategories();
    renderList();
  };
  document.getElementById("categories").appendChild(div);
}

function renderList() {
  const n = searchName.value.toLowerCase();
  const t = searchTag.value.toLowerCase();
  list.innerHTML = "";

  data
    .filter(d =>
      (!activeCategory || d.category === activeCategory) &&
      d.name.toLowerCase().includes(n) &&
      d.tag.toLowerCase().includes(t)
    )
    .forEach(d => {
      list.innerHTML += `
        <div class="card">
          <h4>${d.name}</h4>
          <div class="tag">${d.tag}</div>
          <div class="label">${d.category}</div>
        </div>
      `;
    });
}

searchName.oninput = renderList;
searchTag.oninput = renderList;
</script>

</body>
</html>
